# ============================================================================
# CEREBRO-RED v2 Configuration
# ============================================================================

# Application Settings
CEREBRO_ENV=development
CEREBRO_HOST=0.0.0.0
CEREBRO_PORT=8889
CEREBRO_DEBUG=true
CEREBRO_LOG_LEVEL=INFO

# Verbosity Levels (controls WebSocket event filtering):
# 0 = Minimal (nur Errors, Vulnerabilities)
# 1 = Normal (+ Warnings, Events, Progress)
# 2 = Verbose (+ LLM Requests/Responses, Judge Evaluations)
# 3 = Debug (+ Full Code Flow: strategy selection, mutation steps, judge steps)
CEREBRO_VERBOSITY=3

# Database Configuration
DATABASE_URL=sqlite+aiosqlite:///./data/experiments/cerebro.db
DATABASE_ECHO=false

# Telemetry & Audit Logs
AUDIT_LOG_PATH=./data/audit_logs
AUDIT_LOG_ROTATION=daily
AUDIT_LOG_RETENTION_DAYS=90

# ============================================================================
# LLM Provider Configuration (Multi-Provider Support)
# ============================================================================

# Default Provider (ollama, azure, openai)
DEFAULT_LLM_PROVIDER=ollama

# --- Ollama Configuration ---
OLLAMA_BASE_URL=http://host.docker.internal:11434
OLLAMA_MODEL_ATTACKER=qwen3:8b
OLLAMA_MODEL_TARGET=qwen3:8b
OLLAMA_MODEL_JUDGE=qwen3:14b
OLLAMA_TIMEOUT=300

# --- Azure OpenAI Configuration ---
AZURE_OPENAI_API_KEY=your-azure-api-key-here
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_API_VERSION=2024-02-15-preview
AZURE_MODEL_ATTACKER=gpt-4
AZURE_MODEL_TARGET=gpt-35-turbo
AZURE_MODEL_JUDGE=gpt-4

# --- OpenAI Configuration ---
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_MODEL_ATTACKER=gpt-4-turbo-preview
OPENAI_MODEL_TARGET=gpt-3.5-turbo
OPENAI_MODEL_JUDGE=gpt-4-turbo-preview
OPENAI_TIMEOUT=300

# ============================================================================
# PAIR Algorithm Configuration
# ============================================================================

# Iteration Settings
MAX_ITERATIONS=20
MAX_CONCURRENT_ATTACKS=5
BACKOFF_BASE_DELAY=1.0
BACKOFF_MAX_DELAY=60.0
BACKOFF_MULTIPLIER=2.0

# Success Thresholds
JUDGE_SUCCESS_THRESHOLD=7.0
JUDGE_CONFIDENCE_THRESHOLD=0.8

# ============================================================================
# Security & API Configuration
# ============================================================================

# API Authentication
API_KEY_ENABLED=true
API_KEY=your-secret-api-key-change-this

# CORS Settings
CORS_ORIGINS=http://localhost:5173,http://localhost:3000
CORS_ALLOW_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# ============================================================================
# Research & Experiment Settings
# ============================================================================

# Experiment Defaults
DEFAULT_EXPERIMENT_TIMEOUT=3600
DEFAULT_BATCH_SIZE=10
ENABLE_MUTATION_HISTORY=true
ENABLE_DETAILED_TELEMETRY=true

# Vulnerability Classification
VULNERABILITY_SEVERITY_LEVELS=low,medium,high,critical
AUTO_EXPORT_RESULTS=true
EXPORT_FORMAT=json,csv,pdf

# ============================================================================
# Circuit Breaker Configuration (LLM Resilience)
# ============================================================================

# Number of failures before circuit opens (default: 10)
# Higher values reduce false positives but increase risk of cascading failures
CIRCUIT_BREAKER_FAILURE_THRESHOLD=10

# Number of successes in HALF_OPEN state before closing circuit (default: 3)
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=3

# Seconds before transitioning from OPEN to HALF_OPEN (default: 60.0)
CIRCUIT_BREAKER_TIMEOUT=60.0

# Maximum requests allowed in HALF_OPEN state (default: 5)
CIRCUIT_BREAKER_HALF_OPEN_MAX_CALLS=5

# Enable randomized backoff jitter to prevent thundering herd (default: true)
CIRCUIT_BREAKER_JITTER_ENABLED=true

# Maximum jitter in milliseconds (default: 1000)
CIRCUIT_BREAKER_MAX_JITTER_MS=1000

# Log all circuit breaker state transitions (default: true)
CIRCUIT_BREAKER_LOG_STATE_TRANSITIONS=true
